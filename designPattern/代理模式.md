[[TOC]]

### 定义

**代理模式（proxy）**，为其他对象提供一种代理以控制对象的访问



代理模式结构图

![image-20200301234515923](https://gitee.com/xiaoxiunique/picgo-image/raw/master/image-20200301234515923.png)

- Subject 类，定义了 RealSubject 和 Proxy的共同接口，这样就在任何使用 RealSubject的地方都可以使用 Proxy
- RealSubject类，定义了 Proxy 所代表的真实实体。
- Proxy 类，保存一个引用使得代理访问实体，并提供一个与 Subject 的接口相同的接口，这样代理就可以来替代实体。



### 应用

**java 实现代理模式**

Subject.java

```java
package com.xx.demo.agent;

/**
 * <p>
 * TODO:
 * </p>
 *
 * @author hcg
 * @date 2020/3/4 23:14
 * @className subject
 */
public interface Subject {
    void sayHello();
}

```

RealSubject.java 代理对象，也叫原对象
```java
public class RealSubject implements Subject {
    @Override
    public void sayHello() {
        System.out.println("hello");
    }
}
```

ProxyFactory.java 代理工厂，创建代理类
```java
public class ProxyFactory {

    private Object target;

    public ProxyFactory(Object target) {
        this.target = target;
    }

    public Object getProxyInstance() {
        return Proxy.newProxyInstance(this.target.getClass().getClassLoader(), target.getClass().getInterfaces(), new InvocationHandler() {
            @Override
            public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                System.out.println("我要开始说话了");
                Object value = method.invoke(target, args);
                System.out.println("我已经说完了");
                return value;
            }
        });
    }

    public static void main(String[] args) {
        Subject subject = new RealSubject();
        ProxyFactory proxyFactory = new ProxyFactory(subject);
        Subject proxyInstance = (Subject) proxyFactory.getProxyInstance();
        proxyInstance.sayHello();
    }
}
```